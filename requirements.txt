# requirements.txt
pandas>=1.5.0
requests>=2.28.0
schedule>=1.2.0
python-dotenv>=1.0.0

# .env (template - create your own with actual values)
GOOGLE_SHEET_URL=https://docs.google.com/spreadsheets/d/e/YOUR_SHEET_ID/pub?output=csv
WHATSAPP_API_TOKEN=your_whatsapp_business_api_token
WHATSAPP_PHONE_NUMBER=your_whatsapp_business_phone_number_id
TARGET_PHONE_NUMBER=your_target_phone_number
ALERT_THRESHOLD=1.0
CHECK_INTERVAL=1

# Dockerfile
FROM python:3.11-slim

WORKDIR /app

# Install system dependencies
RUN apt-get update && apt-get install -y \
    gcc \
    && rm -rf /var/lib/apt/lists/*

# Copy requirements and install Python dependencies
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# Copy application code
COPY crypto_alert_system.py .
COPY .env .

# Create logs directory
RUN mkdir -p /app/logs

# Run the application
CMD ["python", "crypto_alert_system.py"]

# docker-compose.yml
version: '3.8'

services:
  crypto-alerts:
    build: .
    container_name: crypto-alert-system
    restart: unless-stopped
    environment:
      - GOOGLE_SHEET_URL=${GOOGLE_SHEET_URL}
      - WHATSAPP_API_TOKEN=${WHATSAPP_API_TOKEN}
      - WHATSAPP_PHONE_NUMBER=${WHATSAPP_PHONE_NUMBER}
      - TARGET_PHONE_NUMBER=${TARGET_PHONE_NUMBER}
      - ALERT_THRESHOLD=${ALERT_THRESHOLD:-1.0}
      - CHECK_INTERVAL=${CHECK_INTERVAL:-1}
    volumes:
      - ./logs:/app/logs
      - ./crypto_alerts.log:/app/crypto_alerts.log
    networks:
      - crypto-network

networks:
  crypto-network:
    driver: bridge

# systemd service file: /etc/systemd/system/crypto-alerts.service
[Unit]
Description=Crypto Alert System
After=network.target

[Service]
Type=simple
User=ubuntu
WorkingDirectory=/home/ubuntu/crypto-alerts
Environment=PATH=/home/ubuntu/crypto-alerts/venv/bin
ExecStart=/home/ubuntu/crypto-alerts/venv/bin/python crypto_alert_system.py
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target

# Railway deployment (railway.toml)
[build]
builder = "NIXPACKS"

[deploy]
startCommand = "python crypto_alert_system.py"
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 3

# Heroku Procfile
worker: python crypto_alert_system.py
